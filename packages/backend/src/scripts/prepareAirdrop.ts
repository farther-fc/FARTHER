import {
  neynarClient,
  neynarScheduler,
  NEYNAR_DATA_SIZE_LIMIT,
} from "@common/neynar";
import { chunk } from "underscore";

// // This should be called once before every airdrop. Update airdropConfig before calling it.
// // After calling it, deploy the airdrop contract with the merkle root and manually update Airdrop.address.
// async function prepareAirdrop() {
//   // Upsert Airdrop record with address, version & amount
//   // Get all pending recipients who have a connected wallet
//   // Create a merkle tree with the above recipients
//   // Update status to ALLOCATED
//   // Store in DB & make text file as backup
// }

const powerUsers = [
  244717, 16351, 4372, 226244, 273576, 262563, 318213, 304818, 6581, 283553,
  1287, 12021, 913, 230147, 350, 284666, 249332, 143, 472, 1145, 3000, 2201,
  2813, 2252, 289333, 3391, 294090, 4293, 284616, 4204, 4627, 4805, 270791,
  290967, 290654, 5057, 288339, 6597, 6741, 6061, 6878, 326062, 306184, 6377,
  7761, 7236, 3797, 7637, 9963, 5283, 9829, 9082, 9926, 291845, 10351, 11850,
  11129, 13475, 13124, 13442, 548, 306341, 3711, 14088, 329284, 302556, 14539,
  3597, 3174, 18910, 262938, 3780, 3882, 214447, 338827, 310124, 358173, 2866,
  17316, 226538, 2735, 4823, 72, 7288, 16353, 211303, 307984, 2268, 5925,
  332047, 332309, 208696, 533, 56, 4179, 5403, 4449, 1015, 330133, 4045, 2163,
  88, 4368, 2628, 308516, 5701, 2455, 11595, 1246, 11213, 1472, 1149, 7438, 52,
  207, 4327, 57, 1401, 964, 1668, 3862, 105, 129, 18, 359, 1118, 8, 2433, 2074,
  5774, 1098, 303, 1918, 15, 323770, 49, 226045, 2631, 2111, 3872, 1841, 3966,
  25, 4345, 895, 468, 569, 2139, 2364, 2228, 3731, 647, 3312, 3239, 3164, 5062,
  4166, 4741, 234616, 326500, 882, 4871, 5498, 5604, 6142, 5197, 6806, 203,
  6823, 110, 102, 8004, 12102, 1610, 317643, 6591, 1184, 7258, 7774, 334585,
  347945, 8346, 8147, 6376, 8304, 8685, 4642, 17065, 337007, 20133, 12567, 7143,
  210698, 13505, 8439, 13219, 9940, 342222, 9166, 6164, 6214, 9101, 9135, 9280,
  2588, 7558, 13418, 10178, 134, 9917, 10447, 9415, 7951, 7076, 3095, 10895,
  6196, 365930, 212111, 221578, 371264, 10452, 12690, 9139, 10715, 13314, 10841,
  8154, 390237, 8890, 10575, 1432, 54, 6631, 7071, 17, 11516, 18989, 8448,
  12573, 4904, 9307, 9653, 9791, 12167, 12925, 9148, 8587, 9856, 12436, 12309,
  12923, 9622, 4606, 1237, 12709, 7142, 15274, 211832, 16309, 4923, 132, 16512,
  194, 9595, 3417, 16707, 8969, 16925, 16719, 190100, 211697, 16617, 16233,
  1097, 1996, 14601, 4434, 6227, 190075, 189976, 20013, 189781, 243300, 12741,
  16567, 189905, 189475, 4163, 5991, 312, 212722, 190218, 191775, 17498, 17571,
  228687, 190552, 319464, 191774, 17969, 190923, 191042, 2007, 17364, 192539,
  18269, 18241, 18763, 12172, 7963, 296207, 4807, 15850, 75, 8998, 2099, 191,
  426, 211838, 301676, 308331, 283, 2586, 762, 4256, 211230, 734, 239, 50, 1657,
  60, 11040, 557, 37, 160, 1887, 66, 2420, 212516, 325, 24, 8531, 213250,
  212581, 212841, 631, 305941, 215164, 1471, 8048, 4085, 2689, 602, 215506,
  1430, 1720, 13833, 12912, 211158, 20633, 22337, 4665, 4409, 375, 14150,
  343580, 343261, 343593, 343389, 2, 17114, 344388, 10710, 15641, 10862, 19,
  270, 67, 8606, 4487, 230238, 1397, 1781, 3300, 1513, 1812, 2466, 2383, 918,
  688, 315256, 3435, 1212, 1092, 1072, 1461, 1010, 8558, 2744, 3454, 11500,
  1911, 5769, 922, 236715, 11489, 18354, 8977, 3439, 3301, 16915, 4311, 11269,
  189574, 20448, 236562, 4020, 17295, 189338, 18858, 14491, 12161, 230519,
  13229, 13572, 14330, 212074, 11149, 4549, 6711, 12847, 194233, 5309, 224391,
  1350, 7516, 198116, 11548, 18381, 238351, 2616, 633, 5172, 1692, 188933,
  232774, 233593, 234014, 238794, 238466, 238564, 238652, 223862, 240383,
  239933, 239587, 241422, 241573, 242245, 212078, 7727, 242191, 437, 243424,
  214445, 266421, 265749, 265951, 269897, 269692, 270214, 277803, 270969,
  271023, 270919, 271373, 270678, 270504, 20147, 271928, 213125, 272085, 281939,
  4808, 272847, 18922, 272717, 273442, 13986, 245862, 245236, 16914, 92, 5643,
  280715, 189715, 280595, 234, 276245, 4686, 234228, 261625, 21291, 280657,
  275635, 281056, 281289, 281676, 281429, 281129, 234404, 11720, 8149, 2783,
  2824, 11392, 15946, 6245, 14831, 12142, 14951, 277630, 284408, 243288, 274082,
  243432, 1279, 12783, 242698, 13969, 571, 2842, 17474, 12944, 18655, 4901,
  192490, 233939, 243803, 4389, 20402, 191554, 4567, 283361, 38, 229232, 308631,
  234343, 249556, 245082, 244858, 245319, 303022, 234141, 245308, 244832,
  244869, 302642, 245252, 240041, 240087, 211535, 238785, 240172, 250455,
  240914, 6844, 14158, 240586, 242582, 253288, 253205, 2502, 746, 15683, 1277,
  11245, 2723, 234286, 321343, 18152, 9832, 248297, 227918, 1001, 4914, 232393,
  254022, 6018, 279567, 3726, 3608, 276128, 18344, 8050, 5767, 236822, 70,
  18198, 12654, 12152, 16191, 191339, 237699, 191497, 3455, 196950, 241873,
  12031, 253, 11161, 3673, 14496, 3551, 5732, 6589, 20384, 219631, 198811, 3881,
  20413, 20493, 10765, 18295, 4519, 11707, 313064, 8173, 6032, 21408, 3781,
  2600, 15590, 3842, 9186, 98, 1733, 14447, 15899, 205754, 15400, 18286, 134059,
  19407, 20066, 264700, 21348, 193930, 4167, 20929, 297512, 309857, 321551, 476,
  190081, 352776, 306610, 269026, 311, 268747, 269694, 271094, 4790, 3240, 324,
  935, 483, 4801, 4090, 4408, 138, 6373, 7110, 7261, 8594, 4753, 9456, 8392,
  11510, 11447, 108, 10677, 12480, 216983, 13676, 217780, 278513, 1048, 14209,
  227242, 1033, 15357, 15835, 15205, 5263, 5326, 5460, 15643, 5593, 17408, 378,
  238, 1776, 20005, 2802, 1, 3895, 20082, 3828, 443, 3924, 7061, 1315, 4910,
  20919, 313886, 318911, 4373, 4724, 4347, 4316, 114, 5491, 3497, 5066, 6815,
  358, 585, 5376, 7692, 7479, 7097, 2653, 2029, 7247, 7960, 314724, 896, 2570,
  3339, 8046, 9019, 8911, 8433, 8113, 320097, 119, 4634, 9700, 328293, 2458,
  5492, 350248, 6112, 308623, 133, 2397, 7529, 3716, 6348, 9260, 302, 1626,
  5713, 7396, 4886, 4918, 4877, 4047, 5987, 139, 40, 539, 903, 51, 10766, 859,
  225, 851, 1725, 1495, 10839, 325558, 1447, 1484, 1715, 6137, 10626, 1544,
  1095, 11037, 2112, 2923, 701, 181, 229150, 932, 754, 197, 162, 217244, 1569,
  10610, 2703, 1356, 1431, 1727, 1795, 13006, 12613, 12708, 12963, 12386, 19677,
  14471, 14484, 211541, 211577, 19832, 13432, 210975, 13970, 13999, 13610,
  13283, 11158, 7620, 11550, 11990, 11816, 11352, 13089, 211384, 5708, 13121,
  20539, 20504, 12535, 211756, 251, 2526, 13875, 14870, 15053, 81621, 14197,
  15983, 14131, 222464, 14520, 710, 14132, 14069, 15667, 301792, 2904, 13696,
  11724, 11050, 15629, 11528, 11056, 9055, 195917, 211272, 330738, 9540, 3059,
  11555, 16098, 11781, 680, 18570, 20067, 19412, 189873, 195523, 188892, 279666,
  195577, 213070, 191212, 194358, 8515, 193089, 516, 20558, 193686, 196767,
  195643, 214123, 196149, 196351, 20104, 18919, 19846, 5034, 16183, 20522,
  20907, 21146, 20228, 4286, 333, 20559, 20811, 20701, 20388, 23563, 125, 6351,
  2902, 81, 194521, 13769, 5431, 1970, 1317, 212364, 21187, 4277, 323241,
  218816, 218952, 228715, 347, 348420, 1380, 5650, 3642, 2559, 351785, 80,
  10810, 354669, 363560, 365925, 365849, 365740, 365536, 366146, 366332, 48,
  3520, 211124, 197256, 8794, 309638, 234199, 4227, 6408, 6536, 233589, 233920,
  7384, 3727, 7717, 234237, 234021, 233254, 233979, 234285, 234363, 7948, 671,
  234475, 8598, 9009, 3295, 8709, 235192, 8744, 8988, 235238, 234817, 234334,
  1972, 236173, 235591, 235510, 235323, 323645, 235913, 191864, 10914, 13201,
  2333, 234743, 219395, 3736, 8821, 5563, 10080, 13203, 15789, 18513, 7369,
  239500, 11360, 14174, 870, 15681, 269518, 278523, 278406, 259597, 263082,
  8476, 261008, 268245, 267667, 11848, 262539, 278655, 262450, 262604, 269169,
  264222, 263333, 263265, 263450, 264487, 265108, 282526, 295781, 4129, 18294,
  284324, 3965, 212640, 16863, 234321, 675, 198629, 44, 285086, 79, 871, 216,
  285257, 279454, 295879, 999, 8207, 1180, 1298, 604, 8438, 1598, 1642, 287066,
  2091, 13151, 6554, 10618, 3406, 7009, 2255, 2514, 10822, 3002, 4040, 9144,
  3928, 21217, 2262, 2512, 2759, 12588, 3193, 13928, 10906, 3441, 3484, 3524,
  245790, 536, 3747, 211205, 366843, 245315, 245309, 308538, 223277, 2827,
  246448, 305455, 308410, 13478, 283222, 238319, 3147, 307736, 248339, 308337,
  244037, 10946, 12651, 308445, 248753, 1734, 4894, 8257, 20965, 2883, 315839,
  3224, 429, 276375, 10703, 224429, 212556, 251605, 966, 6788, 4925, 2326,
  316507, 3180, 13094, 9435, 785, 3109, 212072, 3609, 17268, 7910, 252934, 722,
  8568, 3189, 317896, 211946, 4132, 17064, 14161, 16203, 297185, 324029, 4407,
  262524, 263371, 14532, 20, 18318, 253220, 14537, 369892, 318702, 18661, 19458,
  20045, 314024, 4482, 235153, 2745, 235234, 15355, 3612, 1241, 193551, 301830,
  8244, 366476, 124, 224, 322839, 307080, 797, 794, 366, 6804, 324571, 274, 933,
  276, 258, 204155, 83, 834, 629, 898, 3457, 1006, 349675, 296737, 376944, 1303,
  1087, 2134, 2488, 325886, 5818, 2240, 3700, 2618, 2820, 2952, 101, 308032,
  3831, 7237, 7074, 2282, 828, 7257, 8268, 503, 144, 9410, 738, 2770, 2416,
  331851, 14260, 7212, 332161, 1593, 333327, 4199, 1325, 1485, 398355, 8440,
  299247, 1689, 681, 7048, 9933, 3795, 3362, 165, 224604, 4143, 3447, 8555,
  10259, 10602, 231064, 1236, 725, 269, 281836, 42, 465, 59, 646, 1377, 739,
  1185, 2266, 804, 11984, 11944, 1355, 11821, 3462, 3863, 3662, 1115, 4715,
  4306, 4816, 4973, 2602, 2210, 2185, 4547, 2950, 4742, 4909, 2549, 3007, 5126,
  4564, 12066, 350082, 3557, 12725, 12370, 5965, 1706, 5785, 13713, 457, 5804,
  5787, 13994, 12697, 210628, 6087, 6501, 333224, 14364, 4200, 4795, 337297,
  3504, 5820, 6801, 15671, 15766, 5543, 5181, 1321, 1285, 16437, 771, 1137,
  2417, 880, 3306, 5620, 5666, 339302, 4905, 1766, 6902, 1134, 1129, 1165, 6821,
  2008, 6731, 2687, 1171, 7996, 716, 3017, 3544, 412, 3449, 2270, 8511, 4461,
  210648, 1886, 431, 12874, 12342, 12074, 226476, 13029, 12777, 12822, 17675,
  7933, 28, 43, 53, 12241, 17975, 18057, 16831, 18085, 307834, 18791, 14035,
  13943, 451, 13166, 13364, 13596, 1606, 616, 73, 18586, 18471, 473, 18751,
  224525, 14124, 14241, 14436, 18222, 14497, 18726, 14489, 20368, 14455, 14243,
  14123, 15821, 189940, 20376, 19627, 15441, 188965, 15531, 188352, 106, 1136,
  3621, 8413, 8447, 190115, 191694, 12518, 191272, 381068, 191780, 15576, 5860,
  21071, 9391, 4378, 741, 3115, 193830, 3860, 11188, 5006, 12168, 1992, 280,
  742, 10636, 4036, 213545, 235163, 240638, 240835, 241874, 242127, 243719,
  248216, 267965, 379, 335741, 336612, 369, 337090, 17454, 13434, 576, 342996,
  9369, 20970, 340034, 340259, 6596, 21166, 2558, 11951, 5173, 222071, 230941,
  9702, 318589, 4071, 4826, 3158, 318365, 10737, 15255, 3837, 211674, 3236,
  3413, 11508, 3791, 218814, 4542, 4152, 13474, 4970, 192373, 232059, 232054,
  6089, 5011, 5207, 195806, 10799, 5289, 5844, 5450, 5429, 6473, 5511, 5516,
  3792, 18537, 4370, 8637, 234044, 234219, 16384, 5090, 7749, 21431, 5972,
  242870, 5037, 14184, 243663, 244349, 245439, 244902, 245229, 8024, 249958,
  245219, 246344, 247522, 247859, 247272, 248151, 248344, 248150, 248108,
  249193, 249078, 249122, 251927, 252938, 252180, 253407, 4042, 4109, 4168,
  19805, 5164, 4283, 1979, 4433, 238042, 5448, 902, 6, 9818, 11032, 402, 4413,
  3750, 6422, 4728, 5361, 7848, 19450, 16975, 5758, 13437, 10335, 3087, 5046,
  211333, 5551, 5636, 3255, 2461, 4473, 4865, 189312, 3708, 10101, 3264, 15388,
  14063, 240369, 228144, 240456, 5803, 790, 656, 1139, 19136, 218065, 14982,
  10655, 4332, 238048, 234330, 19815, 234457, 293251, 1595, 8801, 4565, 210432,
  212859, 241334, 246221, 11209, 280586, 2006, 9447, 309567, 309601, 264879,
  310302, 238815, 2248, 188902, 17671, 244272, 7325, 17223, 142, 2042, 20010,
  11923, 281660, 442, 283030, 252346, 252230, 295570, 251053, 14226, 252572,
  15126, 11770, 4726, 5165, 194418, 1656, 253953, 268043, 1607, 1460, 12738,
  18413, 7145, 210746, 10391, 848, 197340, 8166, 18489, 308527, 271142, 191637,
  281687, 277656, 272732, 2727, 328041, 10218, 234327, 236030, 16078, 1948,
  14127, 241925, 1374, 6545, 10570, 212994, 6099, 277244, 210731, 263648, 13936,
  211365, 16041, 322552, 19036, 674, 302380, 5601, 11780, 193239, 263481,
  278170, 227062, 216290, 228904, 24128, 209951, 169, 221717, 245190, 7251,
  18384, 21832, 21039, 268443, 262325, 263142, 9780, 212863, 20694, 262944,
  262475, 989, 262762, 274133, 270637, 263859, 9262, 245213, 245559, 338373,
  307368, 283347, 2878, 3372, 6726, 191294, 196298, 2696, 228880, 7418, 20771,
  281290, 1024, 238829, 247959, 7988, 213314, 231867, 3235, 366212, 314176,
  204173, 809, 343622, 19416, 294100, 5085, 282278, 910, 247466, 23039, 344864,
  299853, 293719, 23382, 279789, 8379, 283320, 242188, 294437, 242165, 4415,
  12388, 733, 3771, 589, 356297, 234804, 308291, 2100, 248111, 5952, 11411,
  298730, 305, 362281, 4802, 17940, 263315, 362883, 319145, 285357, 9222, 5449,
  4275, 7038, 13453, 2757, 12590, 1693, 214318, 1301, 3329, 16085, 20286,
  195960, 838, 4253, 15562, 21798, 20398, 195091, 271403, 190968, 264069,
  216563, 3380, 4351, 20917, 1189, 269164, 13237, 706, 146, 340, 1030, 1364,
  1546, 3395, 4017, 3915, 4998, 10215, 18408, 18517, 239419, 245290, 282520,
  297319, 299082, 301340, 9193, 3368, 1874, 236727, 283441, 305130, 4760,
  330081, 16795, 2982, 20945, 380606, 4290, 332881, 23282, 245306, 238988, 1102,
  3206, 8680, 4873, 188169, 6546, 3, 4612, 206, 5781, 7872, 15974, 20591, 3887,
  212661, 7559, 841, 11299, 191135, 11491, 17761, 15838, 16842, 195466, 951,
  11681, 7941, 354630, 306926, 252228, 10520, 382802, 18130, 263537, 11128,
  9618, 336012, 269405, 218957, 3698, 16142, 308247, 9068, 5951, 2081, 350729,
  8641, 212623, 349075, 264001, 7234, 237845, 1941, 3757, 1894, 6357, 71,
  242729, 7708, 1480, 193699, 238758, 10266, 4836, 13640, 296478, 16189, 300898,
  7378, 2217, 265405, 208239, 305234, 20196, 7163, 245237, 297799, 18545, 2739,
  333868, 298188, 310928, 636, 1357, 272344, 8848, 2070, 234220, 10956, 11746,
  264332, 9412, 2893, 196199, 353123, 342199, 6143, 1258, 358634, 13901, 381245,
  917, 233147, 227645, 2073, 21773, 10103, 282119, 9052, 367850, 2635, 348611,
  2023, 364927, 7596, 2868, 1534, 333732, 245977, 18882, 10428, 210891, 211845,
  237409, 6025, 212, 14911, 388891, 1786, 17582, 20913, 3429, 15851, 8551,
  238172, 249007, 309103, 288257, 304106, 280558, 248230, 248559, 2928, 248284,
  12574, 279848, 94, 13162, 193273, 304875, 14782, 14469, 262357, 232646,
  218753, 198538, 229184, 346751, 196800, 358126, 230446, 311845, 10144, 23357,
  334413, 210586, 20938, 330807, 218710, 268455, 3583, 11004, 382247, 292880,
  339017, 361798, 364017, 4534, 7985, 7464, 8059, 8749, 9337, 10524, 11123,
  11656, 14404, 14885, 14940, 14767, 14908, 19776, 215932, 238178, 241781,
  245124, 247416, 247018, 248101, 249455, 252251, 253659, 263521, 277480,
  293460, 293760, 296687, 302083, 306069, 309413, 312380, 321147, 326040,
  327503, 328903, 329070, 331138, 168, 5106, 4123, 6852, 11569, 12958, 196648,
  625, 670, 1898, 2391, 214841, 7049, 3810, 2530, 4674, 8726, 13082, 189784,
  228109, 278838, 788, 1351, 1194, 5091, 5127, 278203, 19105, 5513, 252002,
  3308, 13626, 7548, 2441, 369466, 221519, 333312, 10143, 6817, 16819, 758,
  5049, 10920, 2859, 221171, 268882, 230392, 3558, 189237, 11997, 17356, 291,
  235923, 270583, 239099, 234448, 307063, 273394, 5644, 7524, 11552, 253270,
  218166, 308913, 273613, 342451, 274947, 282223, 342665, 278402, 3734, 11475,
  342167, 282060, 296520, 886, 17672, 941, 234434, 15211, 3004, 195659, 193958,
  4086, 16340, 196763, 347050, 1043, 5779, 9848, 6023, 5557, 2390, 307224, 8481,
  306392, 237988, 226882, 245097, 214298, 263574, 353257, 6292, 278605, 215322,
  248172, 3506, 4285, 9669, 3635, 14217, 249258, 10095, 240969, 210744, 6111,
  309710, 283144, 30, 2138, 302117, 3347, 4208, 8168, 15633, 267493, 273147,
  238307, 245388, 2211, 14976, 18407, 196387, 2107, 3636, 3615, 4996, 8208,
  20259, 21417, 3958, 7588, 12580, 211534, 2584, 5840, 8421, 2215, 3013, 11448,
  194479, 238463, 4196, 8080, 1349, 1629, 4804, 10530, 20928, 373, 331, 6162,
  878, 331192, 4181, 1333, 236414, 318105, 9138, 187961, 11965, 16192, 14332,
  12095, 7409, 10174, 289743, 8971, 2322, 3724, 1082, 4282, 8136, 242021, 1198,
  9265, 18262, 262717, 6394, 10430, 13323, 211890, 268326, 267820, 2788, 6945,
  16152, 761, 15881, 10, 1104, 19570, 34, 18503, 26, 4895, 5953, 17859, 17858,
  1068, 7316, 17195, 17886, 240516, 16877, 212010, 249216, 283056, 3854, 330642,
  1791, 7341, 263664, 365847, 1110, 366853, 367061, 301193, 366838, 1230, 11512,
  5395, 366753, 261355, 342737, 368835, 330802, 4583, 13870, 377, 3588, 3321,
  4787, 6347, 5624, 4989, 5964, 7112, 8192, 283792, 285999, 18203, 374488,
  324420, 1348, 378890, 20204, 350581, 307128, 617, 651, 16148, 323251, 377935,
  16180, 10694, 16099, 8082, 214172, 345100, 12, 368, 12163, 1214, 6208, 7741,
  364883, 13080, 395794, 6131, 5583, 9698, 2348, 3414, 229042, 318192, 232017,
  248890, 18685, 191213, 234400, 3488, 190045, 4464, 4262, 2460, 18883, 399,
  192336, 15799, 1436, 228117, 4698, 5948, 1101, 228390, 4013, 16286, 238260,
  374165, 1408, 5587, 6751, 13908, 5305, 9050, 269091, 309282, 13495, 2297,
  2494, 7992, 16871, 16987, 1229, 12443, 14298, 23042, 193423, 626, 2728, 18931,
  3096, 188416, 4980, 21, 19716, 347833, 191832, 12834, 8544, 15549, 988, 13252,
  21168, 10695, 12299, 12541, 13436, 19717, 206010, 6171, 14225, 1575, 19796,
  189052, 2443, 6972, 210592, 212849, 5406, 12048, 13387, 237663, 278533,
  315944, 244479, 13797, 18183, 217245, 17106, 20931, 8265, 13803, 19613,
  213526, 231788, 241066, 211301, 240416, 7206, 260770, 3789, 17568, 217341,
  15492, 314898, 11866, 13022, 1999, 12949, 7732, 7790, 244803, 13484, 1103,
  2864, 14070, 230534, 17795, 3804, 18529, 1067, 315, 2454, 9459, 302022, 3801,
  2283, 7781, 13119, 13737, 196166, 228441, 211654, 23192, 291656, 1698, 257144,
  12921, 14198, 209586, 226210, 6090, 227531, 4719, 7189, 1094, 2834, 262970,
  313225, 4240, 20544, 207750, 191475, 243139, 240910, 283597, 313, 7157,
  243906, 247419, 1699, 235170, 242015, 1675, 17354, 279662, 1425, 244367, 8471,
  7085, 231912, 15516, 248300, 14473, 12036, 682, 2222, 4727, 12977, 521, 11467,
  236581, 324808, 343870, 12674, 5365, 326433, 5042, 3123, 1631, 155, 2194,
  247898, 227912, 8627, 2826, 10051, 12224, 1551, 5486, 3237, 3974, 5515, 7214,
  241000, 13030, 207669, 2095, 4343, 8446, 8766, 19530, 233242, 245199, 10502,
  6187, 263587, 268290, 355572, 298064, 11205, 333932, 9198, 261305, 9192,
  325044, 196388, 4991, 307332, 243818, 3702, 318447, 284754, 262439, 15732,
  210538, 271697, 249336, 310367, 292692, 271289, 189733, 3827, 262863, 268937,
  211644, 213115, 264054, 9227, 269880, 307829, 191766, 249141, 335225, 293692,
  9470, 11298, 233952, 240275, 239615, 1520, 3993, 17129, 15713, 17041, 3305,
  265804, 20594, 337511, 227088, 20140, 269000, 330083, 318473, 3254, 193884,
  127, 15224, 330840, 4334, 18458, 18581, 4423, 244529, 236370, 970, 245128,
  714, 192279, 18145, 241408, 17479, 2341, 9149, 9710, 4312, 270112, 248360,
  2235, 11835, 13071, 1711, 10311, 236738, 27, 159, 6048, 8220, 8730, 9051,
  9326, 10503, 23091, 11913, 193998, 211191, 217248, 231442, 233896, 266767,
  261245, 303035, 262525, 264940, 254376, 271566, 366714, 1482, 7012, 188259,
  3855, 5870, 19169, 13443, 21941, 8070, 21191, 2136, 7131, 284558, 776, 212585,
  3353, 8151, 12470, 231923, 308045, 4466, 4155, 24235, 273221, 3459, 3492,
  20969, 2508, 4479, 8706, 248901, 318996, 297531, 961, 897, 9230, 463, 5451,
  15434, 246710, 68, 319675, 12582, 13560, 14493, 14394, 235425, 272522, 292783,
  295600, 295395, 263491, 234131, 263851, 266490, 245241, 270184, 270998,
  279670, 7556, 702, 213618, 226372, 12466, 246871, 215609, 12256, 17979,
  188665, 318610, 4388, 115, 233574, 9228, 187737, 196378, 228548, 4313, 1338,
  210745, 18272, 13682, 13846, 13707, 3996, 1069, 262624, 5625, 16086, 5494,
  6492, 7055, 7021, 9581, 3036, 4019, 6015, 198900, 10779, 2606, 2768, 231990,
  18908, 370077, 11279, 5483, 210558, 233176, 245579, 271592, 16598, 3048, 7278,
  10597, 234233, 17882, 234431, 13874, 235492, 213363, 8942, 849, 13848, 248713,
  248583, 250260, 248032, 16154, 270066, 1050, 238403, 214219, 227886, 1022,
  284407, 4995, 10671, 16467, 10093, 10857, 4215, 800, 242645, 732, 976, 6500,
  196957, 265516, 262206, 310480, 16405, 345160, 263602, 245035, 5189, 13933,
  3602, 9176, 242661, 20071, 1079, 14937, 2755, 5016, 19129, 2649, 18048, 8405,
  16884, 16522, 295704, 17425, 5851, 7715, 15776, 11912, 270684, 297024, 8079,
  4949, 8451, 9134, 9451, 240987, 3112, 3046, 3593, 4525, 12335, 2736, 12990,
  13563, 13086, 192702, 248954, 293107, 893, 4044, 13659, 239081, 260114,
  211693, 222389, 4952, 6906, 11124, 872, 284633, 6986, 211159, 6715, 13893,
  266626, 5253, 211186, 193, 5745, 6968, 2329, 4731, 6791, 17605, 6236, 18723,
  12457, 12915, 18940, 18975, 1652, 10990, 267915, 270138, 274578, 4375, 268572,
  6097, 20270, 803, 639, 16081, 11782, 1584, 193158, 4684, 9528, 11747, 3498,
  4888, 6381, 7657, 10426, 7690, 12144, 267078, 196293, 5179, 4294, 4027, 6841,
  1407, 1580, 4271, 193826, 7408, 268459, 294226, 1114, 10976, 16066, 4280,
  5254, 14932, 19858, 307383, 307754, 8674, 12400, 7468, 8109, 13267, 244819,
  7452, 1240, 315455, 7535, 15275, 3696, 1864, 285178, 339277, 17838, 11155,
  11215, 4357, 2987, 1238, 7123, 16969, 12354, 196346, 234796, 14466, 630, 9318,
  252500, 231603, 8711, 228795, 6901, 239272, 242438, 236454, 19777, 3686,
  11948, 1574, 327391, 8432, 7909, 1493, 211875, 273352, 4926, 16991, 308042,
  5694, 7863, 4134, 11244, 456, 946, 1020, 7759, 3973, 249841, 8086, 324128,
  233726, 6805, 324470, 194519, 17822, 13642, 534, 2480, 238394, 12111, 6561,
  7878, 13077, 20146, 4353, 3871, 15656, 6116, 235627, 365483, 326920, 17186,
  372057, 335, 211669, 3864, 425, 14396, 374167, 12259, 99, 19463, 3647, 238408,
  10420, 528, 18559, 278239, 9816, 10996, 7589, 249396, 6622, 24005, 17005, 309,
  388965, 234552, 623, 189394, 1648, 7115, 2750, 11238, 192291, 260367, 377813,
  349775, 365552, 3346, 3850, 7667, 228139, 230572, 3049, 12888, 4959, 488,
  4048, 5653, 227540, 9218, 18193, 19661, 23, 189761, 293150, 335954, 213144,
  312666, 20391, 10412, 20198, 2085, 11987, 39, 249729, 1220, 5998, 17690, 9548,
  10875, 4522, 8493, 231034, 238655, 14351, 352787, 357745, 360601, 362447,
  365209, 366041, 371561, 387329, 577, 474, 191205, 345272, 5485, 4268, 8039,
  226517, 1655, 8475, 296594, 7066, 196215, 350911, 3073, 299, 226690, 7660,
  16237, 233043, 233880, 20298, 5152, 3348, 8152, 309043, 20301, 18560, 268892,
  291012, 5328, 4140, 289241, 11684, 196380, 262906, 281236, 270048, 270168,
  248872, 265506, 326390, 296628, 323561, 216260, 279394, 247496, 247238,
  188955, 245169, 326231, 21360, 335956, 240247, 12778, 270818, 324985, 17793,
  242052, 188926, 340666, 6437, 2898, 248304, 11760, 293726, 248345, 262892,
  20265, 323, 453, 9111, 2785, 265563, 217530, 18564, 8677, 260, 317, 518, 555,
  172, 643, 86, 177, 97, 189, 204, 16, 45, 78, 767, 176, 307, 477, 341, 621,
  363, 288, 285, 58, 801, 546, 7154, 1062, 2615, 2251, 2236, 2713, 7483, 3114,
  3972, 3987, 3317, 4623, 4864, 4976, 4182, 19840, 20219, 20331, 20638, 234855,
  264602, 4483, 296767, 298650, 262145, 311537, 344866, 234030, 14515, 12569,
  14472, 7318,
];

async function fetchPowerUsers() {
  const fidChunks = chunk(powerUsers, NEYNAR_DATA_SIZE_LIMIT);

  const neynarUserData = await Promise.all(
    fidChunks.map((fids) =>
      neynarScheduler.schedule(() => neynarClient.fetchBulkUsers(fids)),
    ),
  );

  console.log(
    "neynarUserData.length",
    neynarUserData.map((u) => u.users.map((u) => u.username)).flat(),
  );
}

fetchPowerUsers().then(() => {
  console.log("done");
});
